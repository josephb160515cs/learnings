# Security

## How to store passwords in database?

* Dont store passwords as plain strings, since it will be visible to access to the database and will be easily compromised in case of attacks.
* Use a modern hashing function and store the hash in the database, since hash function are one way functions.
* Also add salting to increased security. Salts can be stored in database as plain strings.

## Different methods to authenticate users

### JWT
JSON Web Token (JWT) is an open standard (RFC 7519) that defines a compact and self-contained way for securely transmitting information between parties as a JSON object. This information can be verified and trusted because it is digitally signed.

#### Key Concepts of JWT

1. **Structure**: A JWT is composed of three parts:
    - **Header**
    - **Payload**
    - **Signature**

2. **Encoding**: JWTs are typically encoded using Base64 URL encoding.

3. **Use Cases**: Commonly used for authentication and information exchange.

#### How JWT Works

##### 1. **JWT Structure**

A JWT is structured as follows:

```
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c
```

- **Header**: Contains metadata about the token, such as the signing algorithm and token type.
  ```json
  {
    "alg": "HS256",
    "typ": "JWT"
  }
  ```
- **Payload**: Contains the claims or information you want to transmit (e.g., user information, expiration).
  ```json
  {
    "sub": "1234567890",
    "name": "John Doe",
    "iat": 1516239022
  }
  ```
- **Signature**: Generated by signing the header and payload with a secret key.
  ```
  HMACSHA256(
    base64UrlEncode(header) + "." +
    base64UrlEncode(payload),
    secret)
  ```

##### 2. **Flow of JWT Authentication**

Here’s how the JWT authentication process works, illustrated with a simple diagram:

```
+----------+       +----------+       +----------+
|   User   |       |   API    |       |  Server  |
+----------+       +----------+       +----------+
      |                  |                    |
      |----Login-------->|                    |
      |                  |                    |
      |                  |----Authenticate--->|
      |                  |                    |
      |                  |<----JWT Token-----|
      |                  |                    |
      |<---JWT Token-----|                    |
      |                  |                    |
      |----Request------>|                    |
      |                  |                    |
      |                  |----Validate JWT--->|
      |                  |                    |
      |<---Response------|                    |
      |                  |                    |
```

1. **User logs in**: The user sends their credentials (like username and password) to the API.
2. **API authenticates**: The API checks the credentials against the database.
3. **JWT Token issued**: If the credentials are valid, the API generates a JWT and sends it back to the user.
4. **User makes requests**: The user includes the JWT in the header of subsequent requests.
5. **API validates**: The API validates the JWT (signature, expiration, etc.) and processes the request accordingly.

#### JWT Conventions

- **Header Algorithms**: Common algorithms include:
    - **HS256** (HMAC with SHA-256)
    - **RS256** (RSA Signature with SHA-256)
    - **ES256** (ECDSA with SHA-256)

- **Claims Types**:
    - **Registered Claims**: Standard claims defined by JWT (e.g., `iss` for issuer, `exp` for expiration).
    - **Public Claims**: Can be defined at will and must be collision-resistant.
    - **Private Claims**: Custom claims created to share information between parties.

- **Expiration**: It’s recommended to set an expiration time (`exp` claim) for security reasons.

#### Security Considerations

- **Secret Management**: Keep signing secrets secure and never expose them.
- **Token Expiration**: Regularly refresh tokens to limit the impact of a stolen token.
- **HTTPS**: Always use HTTPS to protect JWTs in transit.

JWTs provide a scalable and efficient way to handle authentication and data sharing between systems, making them a popular choice in modern web applications.
## References

* chatgpt
* https://chatgpt.com/share/6704262b-7028-800c-a39a-2d2fe43628f0
* <https://www.youtube.com/watch?v=zt8Cocdy15c&list=PLCRMIe5FDPseEIW687mH-LZ-DMNbzAQLF&ab_channel=ByteByteGo>

